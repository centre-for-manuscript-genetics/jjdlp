{% extends "library/library_dummy_base.html" %}
{% load staticfiles %}
{% load highlight %}
{% load staticfiles %}
{% load thumbnail %}

{% block content %}
<div class="text">
<div class="books_list">
<div id="result">
	{% if query %}
		{% include 'search/includes/top_paginator.html' %}
	<table class="source_list">
		<thead></thead>
		<tbody>
		{% with result_list=page.object_list %}
		{% if result_list %}
			{% for result in page.object_list %}
			<tr>
				<td class="list_pages">
				{% with frontcover=result.object.page_source.get_frontcover %}
					{% thumbnail frontcover "90x150" crop="100% 0%" as frco_thumb %}
					<a href="{% url 'source_detail' slug=result.object.slug %}">
						<img id="thumbnail" alt="" src="{{ frco_thumb.url }}" width="{{ frco_thumb.width }}" height="{{ frco_thumb.height }}" style="border:1px solid black;">
					</a>
					{% empty %}
						<img id="thumbnail" src="{{ MEDIA_URL }}JJDLP/images/torn_paper_thumb.jpg" width="90" height="150">
					{% endthumbnail %}
				{% endwith %}
				</td>
				<td class="bib_info"><a href="{% url 'source_detail' slug=result.object.slug %}">{% highlight result.object.verbose_source_name with query max_length 100000000 %}</a></td>
				<td><a href="{% url 'haystack_search' %}?q={{ result.object.get_usage }}">{{ result.object.get_usage }}</a></td>
			</tr>
			{% empty %}
			<tr>
				<td class="fail">No sources matched your search criteria "<strong>{{ query }}</strong>". Modify your existing search or try a new query.</td>
			</tr>
			{% endfor %}
		{% endif %}
		{% endwith %}
		</tbody>
	</table>
		{% include 'search/includes/bottom_paginator.html' %}
	{% else %}
	<p>No search query found. Back to the <a href="{% url 'library_home' %}" style="text-decoration: underline;">Library homepage</a>.</p>
	{% endif %}
</div>
</div>
</div>
{% endblock %}
